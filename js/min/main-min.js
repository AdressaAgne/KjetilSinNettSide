function covertToGray(t,r,e){return.299*t+.587*r+.114*e}function getTextColor(t,r,e){return covertToGray(t,r,e)>186?"#222222":"#fefefe"}function getAverageRGB(t){var r=5,e={r:0,g:0,b:0},a=document.createElement("canvas"),n=a.getContext&&a.getContext("2d"),o,g,u,i=-4,c,d={r:0,g:0,b:0},f=0;if(!n)return e;u=a.height=t.naturalHeight||t.offsetHeight||t.height,g=a.width=t.naturalWidth||t.offsetWidth||t.width,n.drawImage(t,0,0);try{o=n.getImageData(0,0,g,u)}catch(h){return alert("Could not load image data"),e}for(c=o.data.length;(i+=4*r)<c;)++f,d.r+=o.data[i],d.g+=o.data[i+1],d.b+=o.data[i+2];return d.r=~~(d.r/f),d.g=~~(d.g/f),d.b=~~(d.b/f),d}function darken(t,r){return color(t,!0,r)}function lighten(t,r){return color(t,!1,r)}var color=function(t,r,e,a){function n(e){return Math[r?"max":"min"](t[e]+a,r?0:255)}a=Math.round(e?e:51.2)*(r?-1:1);var o=[];return o.r=n(0),o.g=n(1),o.b=n(2),o};